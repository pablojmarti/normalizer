#!/usr/bin/env ruby
require 'csv'
require 'date'

# TODO: create options parser that will explain how this script will work

# check to see if anything is passed to stdin
# if not set the value to 1 that way we can raise an error
input_csv = (STDIN.tty?) ? 1 : $stdin.read

raise "No STDIN given" if input_csv.equal?(1)

parsed_csv = CSV.parse(input_csv, headers: true)

parsed_csv.each do |row|

  # here we interpolate the timezone (US /PST) to be included in the row and then call 
  # new offset to get the time zone to be in US/EST
  # convert to string from date time and then encode to utf-8
  time = DateTime.strptime("#{row['Timestamp']}-800", '%m/%d/%y %H:%M:%S %p%z').new_offset("-500").to_s.encode("UTF-8")

  # multiply the string 0 by the difference of 5 and the length of the original zip code, 
  # which then gets prepended to the original zip code
  zip = ("0" * ( 5 - row['ZIP'].length()) + row['ZIP']).encode("UTF-8")

  full_name = row["FullName"].upcase.encode("UTF-8")
  
  # testing output
  puts time
  puts zip
  puts full_name
  puts row["Address"].encode("UTF-8")

  # save into new hash ensure utf-8 on object
end


# save into new hash
# at the end output as csv to stdout
